\documentclass[11pt, oneside]{amsart}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ...
%\geometry{landscape}                		% Activate for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{hyperref}

%SetFonts
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}


\nonstopmode
\input{macros}

% rules for for inputed tables
% the
\usepackage{siunitx}
\usepackage{booktabs}

%alternative rules for tables
%\newcommand{\toprule}{\hline}
%\newcommand{\midrule}{\hline}
%\newcommand{\bottomrule}{\hline}
%\newcommand{\specialrule}{}

%SetFonts



\title{Algebraic filtering of surfaces from medical images with Julia}
\author{Miroslav Jirik and Alberto Paoluzzi}
\date{}							% Activate to display a given date or no date

\begin{document}
\maketitle

\begin{abstract}
In this paper we introduce a novel algebraic \textsc{lar-surf} filter, well founded on algebraic topology methods, to extract and smooth the boundary surface of any subset of voxels arising from  segmentation of a 3D medical image. The input is defined as a \emph{chain}, i.e.~as a vector from a linear space of 3-chains, represented in coordinates as a sparse binary vector. The output is produced by a linear mapping between spaces of 3- and 2-chains through the boundary operator $\partial_3:C_3 \to C_2$.  In particular, when the input set of voxels is either not (4-)connected, or contains one or more empty regions inside, \textsc{lar-surf} generates a non connected set of closed surfaces, i.e.~a set of 2-cycles---using the language of algebraic topology. The only data structures used by this approach are sparse arrays with one or two indices, i.e.~sparse vectors and matrices. This work is based on LAR (Linear Algebraic Representation) methods, and is implemented in Julia language, natively supporting parallel computing on hybrid architectures.
\end{abstract}

\tableofcontents

%\section{}
%\subsection{}

\input{intro}
\input{background}
\input{design}
\input{implementation}
\input{examples}
\input{conclusion}



\appendix
\section{Appendix}
\subsection{Symbol list}

\begin{description}
\item[$\mathcal{I}$]  three-dimensional medical image

\item[$\ell_1, \ell_2, \ell_3$]  dimensions of image

\item[$\mathcal{S}$]  segment: a subset of voxels from image segmentation

\item[$\mathcal{B}$] 3D image block

\item[$size$] lateral dimension of cubic block $\mathcal{B}$

\item[$n$]	number of blocks $\mathcal{B}$ (jobs) in $\mathcal{I}$

\item[[$\partial_\mathcal{B}$] ]  boundary matrix for block $\mathcal{B}$

\item[$C_p$] linear (vector) space of $p$-chains

\item[$\nu\in C_p$] $p$-chain

\item[[$\nu$]] coordinate representation (binary vector) of  $\nu$

\item[$\E^3$] Euclidean 3-space
\end{description}


\subsection{Definitions}
\begin{description}

\item[Boundary model] Closed manifold surface of the boundary of a solid model

\item[CSC]  Compressed Sparse Column format for sparse matrices

\item[Global coordinates]  Integer linear coordinates of $\mathcal{I}$

\item[Local coordinates] Integer linear coordinates of $\mathcal{B}$

\item[Cartesian coordinates] Integer triples $(i,j,k)$ one-to-one with voxels

\item[Voxels] Individual elements in 3D image (3-cells)

\item[$p$-chain] Formal linear combination of $p$-cells with coefficients in $\{0,1\}$

\item[Coord. repr.]  Binary vector (for $p$-chains) or binary matrix (for chain operators)

\item[Quad]	Geometric quadrilateral; convex polygon with four vertices

\item[Foreground voxel] Individual element of a segment $\mathcal{S}$

\item[Segment]	Subset of voxels resulting from image segmentation
\end{description}

\subsection{Dataset Ircad}

\begin{table}
\input{input/dataset_ircad}
\label{tab:ircad1}
\end{table}

\begin{table}
\input{input/dataset_ircad_desc}
\label{tab:ircad2}
\end{table}

\clearpage{}
\bibliographystyle{alpha}
\bibliography{library,TSAS-2019}

\end{document}
